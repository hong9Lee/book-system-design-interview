# system-design-interview
`참고서적` 가상면접 사례로 배우는 대규모 시스템 설계 기초


## 뉴스 피드 시스템 설계

### 1. 문제 이해 및 설계 범위 확정  
앱, 웹 모두 지원해야 한다.  
사용자는 뉴스 피드에 친구들만 볼 수 있는 새로운 스토리를 올릴 수 있다. 스토리는 시간 흐름 역순으로 표시된다.  
사용자는 최대 5,000명의 친구를 가질 수 있다.  
10M DAU  
스토리는 이미지, 비디오 등의 미디어 파일도 포함될 수 있다.

2. 개략적 설계안 제시 및 동의 구하기  
- 피드 발행  
사용자가 스토리를 포스팅하면 데이터를 캐시&DB에 저장한다.  
친구의 뉴스 피드에도 전송된다.  
- 뉴스 피드 생성  
모든 친구의 포스팅을 시간 흐름 역순으로 모아서 만든다.  
  
뉴스 피드 API  
클라이언트가 서버와 통신하기 위해 사용하는 수단.  

피드 발행 API  
피드 읽기 API  


3. 상세 설계  
피드 발행 흐름 상세 설계  
웹 서버  
인증  
인증 토큰을 Authorization 헤더에 넣는다.  
처리율 제한  
일정 기간 동안 한 사용자가 올릴 수 있는 포스팅 수에 제한을 둔다.  
포스팅 전송(팬아웃) 서비스  
사용자의 새 포스팅을 친구관계에 있는 서비스에게 전달하는 과정  
쓰기 시점에 팬아웃 (push)  
포스팅이 완료되면 사용자의 캐시에 포스팅 기록  
장점  
피드가 실시간으로 갱신됨  
피드를 읽는 시간이 빨라짐  
단점  
친구가 많은 경우 많은 시간 소요됨 (핫키)  
서비스를 자주 사용하지 않는 사용자의 피드까지 갱신해야하므로 자원 낭비  
읽기 시점에 팬아웃 (pull)  
피드를 읽는 시점에 피드를 갱신한다.  
장점  
컴퓨팅 자원을 절약할 수 있다.  
핫키 문제가 생기지 않는다.  
단점  
피드를 읽는데 많은 시간이 소요될 수 있다.  
→ 대부분의 사용자에게는 push. 친구가 많은 사용자의 경우에는 팔로워가 pull할 때 사용 + 안정해시  

